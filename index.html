<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sudoku Solver From Image</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Poppins', sans-serif;
    }
    .loader-spinner {
      border: 4px solid rgba(255, 255, 255, 0.3);
      border-top: 4px solid #4f46e5;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    .share-container {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 999;
    }
    .share-button, .share-options a {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        border: none;
        background: white;
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 8px;
    }
    .share-button:hover,
    .share-options a:hover {
        transform: translateY(-5px) scale(1.05);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
    }
    .share-button img {
        width: 60%;
    }
    .share-options {
        display: none;
        flex-direction: column;
        align-items: center;
        gap: 15px;
        margin-bottom: 15px;
        transform-origin: bottom center;
        animation: fadeIn 0.3s ease forwards;
    }
    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: scale(0.9);
        }
        to {
            opacity: 1;
            transform: scale(1);
        }
    }
    .share-options a img {
        width: 65%;
    }
    .bounce {
        animation: bounce 2s infinite;
    }
    @keyframes bounce {
        0%, 20%, 50%, 80%, 100% {
            transform: translateY(0);
        }
        40% {
            transform: translateY(-10px);
        }
        60% {
            transform: translateY(-5px);
        }
    }
  </style>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col items-center">

  <!-- Header -->
  <header class="bg-white/80 backdrop-blur-lg shadow-sm w-full fixed top-0 left-0 right-0 z-50">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div class="flex items-center justify-between h-20">
              <!-- Logo and Title Section -->
              <div class="flex items-center gap-4">
                  <img src="logo.svg" alt="Sudoku Solver Logo" class="h-14 w-14 object-contain" onerror="this.onerror=null;this.src='https://placehold.co/64x64/4f46e5/ffffff?text=S';" />
                  <h1 class="text-2xl sm:text-3xl font-bold text-gray-800 tracking-tight">Sudoku Vision</h1>
              </div>

              <!-- Follow Us Section -->
              <div class="hidden md:flex items-center gap-4 text-gray-600 font-semibold">
                  <span>Follow Us:</span>
                  <div class="flex gap-3">
                      <a href="https://www.facebook.com/profile.php?id=61576823879176&mibextid=rS40aB7S9Ucbxw6v" target="_blank" rel="noopener noreferrer" class="hover:opacity-75 transition-opacity">
                          <img src="facebook.svg" alt="Facebook" class="h-6 w-6" onerror="this.onerror=null;this.src='https://placehold.co/24x24/3b5998/ffffff?text=FB';" />
                      </a>
                      <a href="https://www.instagram.com/mohanty.satyaprakash.22/" target="_blank" rel="noopener noreferrer" class="hover:opacity-75 transition-opacity">
                          <img src="instagram.svg" alt="Instagram" class="h-6 w-6" onerror="this.onerror=null;this.src='https://placehold.co/24x24/C13584/ffffff?text=IG';" />
                      </a>
                      <a href="https://mobile.x.com/SubashChan12922" target="_blank" rel="noopener noreferrer" class="hover:opacity-75 transition-opacity">
                          <img src="twitter.svg" alt="Twitter/X" class="h-6 w-6" onerror="this.onerror=null;this.src='https://placehold.co/24x24/000000/ffffff?text=X';" />
                      </a>
                      <a href="https://pin.it/1ZWNQjRrb" target="_blank" rel="noopener noreferrer" class="hover:opacity-75 transition-opacity">
                          <img src="pinterest.svg" alt="Pinterest" class="h-6 w-6" onerror="this.onerror=null;this.src='https://placehold.co/24x24/BD081C/ffffff?text=P';" />
                      </a>
                      <a href="https://www.youtube.com/@SubashChandraMohanty-ml2lw" target="_blank" rel="noopener noreferrer" class="hover:opacity-75 transition-opacity">
                          <img src="youtube.svg" alt="YouTube" class="h-6 w-6" onerror="this.onerror=null;this.src='https://placehold.co/24x24/FF0000/ffffff?text=YT';" />
                      </a>
                      <a href="mailto:satyaprakashmohanty2008@gmail.com" class="hover:opacity-75 transition-opacity">
                          <img src="email.svg" alt="Email" class="h-6 w-6" onerror="this.onerror=null;this.src='https://placehold.co/24x24/7f8c8d/ffffff?text=EM';" />
                      </a>
                  </div>
              </div>
          </div>
      </div>
  </header>

  <!-- Main content area -->
  <main class="max-w-2xl w-full p-4 sm:p-6 lg:p-8 mt-28">
    
    <!-- Drop Zone -->
    <div id="drop-zone" class="border-2 border-dashed border-indigo-300 p-10 rounded-2xl bg-white text-gray-600 hover:bg-indigo-50 hover:border-indigo-500 transition-all duration-300 ease-in-out cursor-pointer text-center shadow-sm">
        <svg class="mx-auto h-12 w-12 text-indigo-400" stroke="currentColor" fill="none" viewBox="0 0 48 48" aria-hidden="true">
            <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
        </svg>
        <p class="mt-4 text-lg font-semibold">Click or drag & drop your Sudoku image</p>
        <p class="text-sm text-gray-500">PNG, JPG, GIF up to 10MB</p>
    </div>
    <input type="file" id="file-input" class="hidden" accept="image/*" />

    <!-- Loader -->
    <div id="loader" class="hidden flex flex-col items-center justify-center mt-8 text-indigo-600 text-lg font-semibold">
      <div class="loader-spinner mb-4"></div>
      <span>Solving... Please Wait</span>
    </div>

    <!-- Message Display -->
    <div id="message" class="mt-6 text-center text-lg font-medium text-gray-800"></div>

    <!-- Result Container -->
    <div id="result-container" class="hidden mt-8 text-center">
        <img id="result" class="mx-auto max-w-full h-auto rounded-xl shadow-lg border-4 border-white" alt="Solved Sudoku" />
        <button id="download-btn" class="mt-6 w-full py-3 px-6 bg-indigo-600 text-white font-bold rounded-lg shadow-md hover:bg-indigo-700 transition-all duration-300 ease-in-out focus:outline-none focus:ring-4 focus:ring-indigo-300 flex items-center justify-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
            </svg>
            Download Solved Image
        </button>
    </div>
  </main>
  
  <div class="share-container">
    <div class="share-options" id="share-options">
      <a class="bounce" onclick="shareTo('whatsapp')" title="WhatsApp">
        <img src="whatsapp.svg" alt="WhatsApp" onerror="this.onerror=null;this.src='https://placehold.co/36x36/25D366/ffffff?text=WA';">
      </a>
      <a class="bounce" onclick="shareTo('facebook')" title="Facebook">
        <img src="fb.svg" alt="Facebook" onerror="this.onerror=null;this.src='https://placehold.co/36x36/1877F2/ffffff?text=FB';">
      </a>
      <a class="bounce" onclick="shareTo('instagram')" title="Instagram">
        <img src="ins.svg" alt="Instagram" onerror="this.onerror=null;this.src='https://placehold.co/36x36/E4405F/ffffff?text=IG';">
      </a>
      <a class="bounce" onclick="shareTo('telegram')" title="Telegram">
        <img src="telegram.svg" alt="Telegram" onerror="this.onerror=null;this.src='https://placehold.co/36x36/26A5E4/ffffff?text=TG';">
      </a>
    </div>
  
    <button class="share-button" onclick="toggleShare()">
      <img src="share.svg" alt="Share" onerror="this.onerror=null;this.src='https://placehold.co/36x36/7f8c8d/ffffff?text=SH';">
    </button>
  </div>


  <script>
    const dropZone = document.getElementById('drop-zone');
    const fileInput = document.getElementById('file-input');
    const loader = document.getElementById('loader');
    const resultContainer = document.getElementById('result-container');
    const resultImg = document.getElementById('result');
    const message = document.getElementById('message');
    const downloadBtn = document.getElementById('download-btn');

    const API_URL = "/api/solve"; 

    dropZone.addEventListener('click', () => fileInput.click());
    fileInput.addEventListener('change', () => {
      if (fileInput.files[0]) {
        handleFileUpload(fileInput.files[0]);
      }
    });

    dropZone.addEventListener('dragover', (e) => {
      e.preventDefault();
      dropZone.classList.add('border-indigo-500', 'bg-indigo-50');
    });

    dropZone.addEventListener('dragleave', () => {
      dropZone.classList.remove('border-indigo-500', 'bg-indigo-50');
    });

    dropZone.addEventListener('drop', (e) => {
      e.preventDefault();
      dropZone.classList.remove('border-indigo-500', 'bg-indigo-50');
      const file = e.dataTransfer.files[0];
      if (file) {
        handleFileUpload(file);
      }
    });

    downloadBtn.addEventListener('click', () => {
      const a = document.createElement('a');
      a.href = resultImg.src;
      a.download = 'solved_sudoku.png';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
    });

    async function handleFileUpload(file) {
      const formData = new FormData();
      formData.append("file", file);

      loader.classList.remove('hidden');
      message.textContent = '';
      resultContainer.classList.add('hidden');
      resultImg.src = '';
      dropZone.classList.add('hidden');

      try {
        const res = await fetch(API_URL, {
          method: "POST",
          body: formData
        });

        const data = await res.json();
        loader.classList.add('hidden');

        if (res.ok && data.image) {
          message.textContent = data.message || "Sudoku solved successfully!";
          message.classList.remove('text-red-600');
          message.classList.add('text-green-600');
          resultImg.src = `data:image/png;base64,${data.image}`;
          resultContainer.classList.remove('hidden');
        } else {
          message.textContent = data.message || "Failed to solve Sudoku. Please try another image.";
          message.classList.remove('text-green-600');
          message.classList.add('text-red-600');
          dropZone.classList.remove('hidden');
        }
      } catch (err) {
        loader.classList.add('hidden');
        message.textContent = "An error occurred: " + err.message;
        message.classList.remove('text-green-600');
        message.classList.add('text-red-600');
        dropZone.classList.remove('hidden');
        console.error("Fetch error:", err);
      }
    }
    
    const shareOptions = document.getElementById("share-options");
    const shareUrl = encodeURIComponent(window.location.href);

    function toggleShare() {
        if (shareOptions.style.display === "flex") {
            shareOptions.style.animation = "fadeOut 0.3s ease forwards";
            setTimeout(() => {
                shareOptions.style.display = "none";
            }, 300);
        } else {
            shareOptions.style.display = "flex";
            shareOptions.style.animation = "fadeIn 0.3s ease forwards";
        }
    }

    @keyframes fadeOut {
        from {
            opacity: 1;
            transform: scale(1);
        }
        to {
            opacity: 0;
            transform: scale(0.9);
        }
    }

    function shareTo(platform) {
        let url = "";
        const text = encodeURIComponent("Check out this awesome Sudoku solver!");
        switch (platform) {
            case "whatsapp":
                url = `https://wa.me/?text=${text}%20${shareUrl}`;
                break;
            case "facebook":
                url = `https://www.facebook.com/sharer/sharer.php?u=${shareUrl}`;
                break;
            case "instagram":
                alert("Instagram does not support direct web sharing. Please share the link manually!");
                return;
            case "telegram":
                url = `https://t.me/share/url?url=${shareUrl}&text=${text}`;
                break;
            default:
                return;
        }
        if (url) window.open(url, "_blank");
    }
  </script>
</body>
</html>

